!function(){var t;function n(){}n.prototype={toString:()=>"nil"},t={Nil:n,getNil:function(){const t=new n;return Object.freeze(t)}};var e;const{getNil:r}=t;function o(){this.dictionary={}}function i(t){return t.split("\n").map(t=>"    "+t).join("\n")}o.prototype={getSafeKey:function(t){if("string"!=typeof t)throw new Error("Dictionary keys can only be strings.");return t.toLowerCase()},keys:function(){return Object.keys(this.dictionary)},hasKey:function(t){const n=this.getSafeKey(t);return void 0!==this.dictionary[n]},read:function(t){const n=this.getSafeKey(t);return void 0!==this.dictionary[n]?this.dictionary[n]:r()},remove:function(t){const n=this.getSafeKey(t);this.dictionary[n]=void 0,delete this.dictionary[n]},set:function(t,n){const e=this.getSafeKey(t);return this.dictionary[e]=n,this},toString:function(){let t=Object.keys(this.dictionary).map(t=>(value="string"==typeof this.dictionary[t]?`"${this.dictionary[t]}"`:this.dictionary[t].toString(),1===value.split("\n").length?i(`${t}: ${value}`):i(`${t}: \n${i(value)}`)));return["Dictionary {"].concat(t).concat(["}"]).join("\n")}},e={Dictionary:o,getDictionary:function(){return new o}};var s={};const{Nil:a}=t,{Dictionary:c}=e;function u(t=null){this.identifiers={},this.parent=t}u.prototype={define:function(t,n){Object.defineProperty(this.identifiers,t,{get:function(){return n},set:function(){throw new Error(`Cannot update ${t}. It is a constant value.`)}})},getValueType:function(t){return Array.isArray(t)?"array":t instanceof a?"nil":t instanceof c?"dictionary":typeof t},matchesOriginalType:function(t,n){return n instanceof a||t===this.getValueType(n)},initialize:function(t,n){const e=this.getValueType,r=this.matchesOriginalType.bind(this),o=this.getValueType(n);let i=n;Object.defineProperty(this.identifiers,t,{get:function(){return i},set:function(n){if(!r(o,n))throw new Error(`Cannot assign '${n}' to '${t}'. New value type must be '${o}', but got '${e(n)}'`);i=n}})},read:function(t){if(void 0!==this.identifiers[t])return this.identifiers[t];if(null!==this.parent)return this.parent.read(t);throw new Error(`Cannot read variable '${t}'. It has not been created.`)},update:function(t,n){if(void 0!==this.identifiers[t])this.identifiers[t]=n;else{if(null===this.parent)throw new Error(`Cannot update variable '${t}'. It has not been created.`);this.parent.update(t,n)}},new:function(){return u.new(this)},getIdentifiers:function(){return Object.keys(this.identifiers)}},u.new=function(t){return new u(t)},s=u;var f,l,p,h=f={};function y(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}function w(t){if(l===setTimeout)return setTimeout(t,0);if((l===y||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(n){try{return l.call(null,t,0)}catch(n){return l.call(this,t,0)}}}!function(){try{l="function"==typeof setTimeout?setTimeout:y}catch(t){l=y}try{p="function"==typeof clearTimeout?clearTimeout:d}catch(t){p=d}}();var m,g=[],b=!1,v=-1;function k(){b&&m&&(b=!1,m.length?g=m.concat(g):v=-1,g.length&&E())}function E(){if(!b){var t=w(k);b=!0;for(var n=g.length;n;){for(m=g,g=[];++v<n;)m&&m[v].run();v=-1,n=g.length}m=null,b=!1,function(t){if(p===clearTimeout)return clearTimeout(t);if((p===d||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{p(t)}catch(n){try{return p.call(null,t)}catch(n){return p.call(this,t)}}}(t)}}function S(t,n){this.fun=t,this.array=n}function T(){}h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];g.push(new S(t,n)),1!==g.length||b||w(E)},S.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=T,h.addListener=T,h.once=T,h.off=T,h.removeListener=T,h.removeAllListeners=T,h.emit=T,h.prependListener=T,h.prependOnceListener=T,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0};var $={};(function(n){const{Nil:r,getNil:o}=t,{Dictionary:i,getDictionary:s}=e;function a(t,n,e){if("number"!=typeof n||"number"!=typeof e)throw new Error(`All values provided to ${t} must be numbers; values received are: ${n} of type ${typeof n} and ${e} of type ${typeof e}`)}$=function({promptSync:t,clear:e}){let c={newArray:function(...t){return t},appendTo:function(t,n){if(!Array.isArray(t))throw new Error("Append can only add values to an array.");return t.push(n),t}};return c.newDictionary=s,c.hasKey=function(t,n){if(!t instanceof i)throw new Error("Keys can only be accessed on a dictionary.");return t.hasKey(n)},c.getKeysFrom=function(t){if(!t instanceof i)throw new Error("Keys can only be accessed on a dictionary.");return t.keys()},c.readFrom=function(t,n){let e;if(t instanceof i){const r=n.toLowerCase();e=t.read(r)}else if(Array.isArray(t))e=t[parseInt(n)-1];else{if(!(t instanceof r))throw new Error("ReadFrom can only be used on dictionaries, arrays, and Nil.");e=null}return null==e?o():e},c.removeFrom=function(t,n){if(t instanceof i){const e=n.remove(n);return t.read(e)}if(Array.isArray(t)){const e=parseInt(n)-1;return t.splice(e,1),t}throw new Error("Remove can only be used on dictionaries and arrays.")},c.setOn=function(t,n,e){if(!t instanceof i)throw new Error("Values may only be set on a dictionary.");return t.set(n.toLowerCase(),e),t},c.updateOn=function(t,n,e){if(t instanceof i)console.log("Update key: ",n),t.set(n.toLowerCase(),e);else{if(!Array.isArray(t))throw new Error("Values may only be updated on a dictionary or array.");t[n-1]=e}return t},c.isNil=function(t){return t instanceof r},c.newNil=function(){return o()},c.print=function(...t){t.forEach((function(t){"object"==typeof window&&"function"==typeof window.print?window.print(t):console.log(t)}))},c.prompt=async function(n){return"object"==typeof window?new Promise((function(t){setTimeout((function(){const e=definedPrompt(n),r=null===e?"":e.trim();t(r)}),10)})):t()(n).trim()},c.readKey=async function(){return"object"==typeof window?new Promise((function(t){document.addEventListener("keypress",(function n(e){document.removeEventListener("keypress",n),t(e.key)}))})):new Promise((function(t){n.stdin.resume(),n.stdin.setRawMode(!0),n.stdin.setEncoding("utf8"),n.stdin.on("data",(function(e){n.stdin.pause(),n.stdin.setRawMode(!1),t(e)}))}))},c.clearScreen=function(){"object"==typeof window?window.clear():e()},c.join=function(...t){return t.join("")},c.toLowerCase=function(t){return t.toLowerCase()},c.toUpperCase=function(t){return t.toUpperCase()},c.toArray=function(t,n=""){return t.split(n)},c.stringToNumber=function(t){if("string"!=typeof t)throw new Error("Function stringToNumber requires a string.");return parseFloat(t)},c.getCharacterAtIndex=function(t,n){if("string"!=typeof t)throw new Error(`Cannot read characters from a non-string value. Got ${t} of type ${typeof t}.`);return t[n-1]},c.lengthOf=function(t){return t.length},c.numberToString=function(t){if("number"!=typeof t)throw new Error("Function numberToString requires an argument of type number.");return t.toString()},c.not=function(t){if("boolean"!=typeof t)throw new Error(`Cannot apply 'not' function to non-boolean values. Got value ${t} of type ${typeof t}`);return!t},c.wait=function(t){if("number"!=typeof t)throw new Error("Function wait requires the number of seconds to wait, as a number.");return new Promise((function(n){setTimeout((function(){n(!0)}),1e3*t)}))},c.random=function(t=0,n=1){a("random",t,n);const e=(t>=n?t+Math.abs(n):n)-t;return Math.random()*e+t},c.absoluteValue=function(t){return Math.abs(t)},c.floor=function(t){return Math.floor(t)},c.ceiling=function(t){return Math.ceil(t)},c.squareRoot=function(t){return Math.sqrt(t)},c.power=function(t,n){return a("power",t,n),Math.pow(t,n)},c.maximum=function(t,n){return a("maximum",t,n),t>n?t:n},c.minimum=function(t,n){return a("minimum",t,n),t<n?t:n},c.remainder=function(t,n){return a("modulus",t,n),t%n},c.round=function(t,n){a("round",t,n);const e=Math.pow(10,n);return Math.round(t*e)/e},c.log=function(t,n=Math.E){return a("log",t,n),Math.log(t)/Math.log(n)},c}}).call(this,f);const x=["true","false"],C=["be","as","to","with","while","withparameters"],O=["loop","repeat","if","else","function"],L=["let","define","declare"],A=["::","toInfix"],j={operators:["+","-","*","/"],openGroupDelimiter:"(",closeGroupDelimiter:")",functionExecutionIndicator:":",stringBeginIndicator:'"',stringEndIndicator:'"',stringEscapeCharacter:"\\",commentCharacter:"#",whitespaceCharacter:"s",subtractionToken:"-"},I=["isGreaterThan","isLessThan","isGreaterOrEqualTo","isLessOrEqualTo","isEqualTo"].map(t=>t.toLowerCase()),B={Number:t=>/^\-?[0-9]+(\.[0-9]+)?$/.test(t),Boolean:t=>x.includes(t.toLowerCase()),String:t=>t[0]===j.stringBeginIndicator&&t[t.length-1]===j.stringEndIndicator,AssignmentCommand:t=>L.includes(t),InfixOperator:t=>A.includes(t),LineContinuationOperator:t=>"..."===t,Operator:t=>j.operators.concat(["and","or"]).concat(I).includes(t),FunctionExecutionIndicator:t=>t===j.functionExecutionIndicator,OpenGroupDelimiter:t=>t===j.openGroupDelimiter,CloseGroupDelimiter:t=>t===j.closeGroupDelimiter,OpenBlockDelimiter:t=>"begin"===t.toLowerCase(),CloseBlockDelimiter:t=>"end"===t.toLowerCase(),TransitionalOperator:t=>C.includes(t.toLowerCase()),CallOperator:t=>"call"===t.toLowerCase(),ControlOperator:t=>O.includes(t.toLowerCase()),Identifier:()=>!0},D=Object.keys(B).map(t=>({type:t,test:B[t]}));var N={grammarTypes:Object.keys(B).reduce((function(t,n){return t["is"+n]=B[n],t}),{}),tokenTypes:Object.keys(B).reduce((function(t,n){return t[n]=n,t}),{}),getTokenType:function(t){const n=D.filter(n=>n.test(t)).map(t=>t.type)[0];if(void 0===n)throw new Error("Unknown value or symbol in source code: "+t);return n},characterSet:j};const G=N.tokenTypes,{stringBeginIndicator:F,stringEndIndicator:P,stringEscapeCharacter:R,commentCharacter:M,whitespaceCharacter:q,subtractionToken:K}=N.characterSet;function U(t){return/[\s\t]/.test(t)}function V(t){let n="",e=0;for(let r=0;r<t.length;r++){const o=t[r];if(o===R)n+=t[r+1],r++;else{if(o===P){e=r+1;break}n+=o}e=r}return[n,e]}function z(t,n){const e=t.split(""),r=[];let o;const i=function(t){return function(n,e){""!==n&&t.push(function(t,n){const e=t[0]===F?t:t.toLowerCase();return{line:n,token:e,originalToken:t,type:N.getTokenType(e)}}(n,e))}}(r),s=()=>o="",a=()=>{i(o,n),s()};s();for(let c=0;c<e.length;c++){const t=e[c];if(t===M)break;if(":"===t&&":"===e[c+1])a(),o="::",c++,a();else if(N.grammarTypes.isOperator(t)||N.grammarTypes.isOpenGroupDelimiter(t)||N.grammarTypes.isCloseGroupDelimiter(t)||N.grammarTypes.isFunctionExecutionIndicator(t)){a(),o=t;const n=r[r.length-1];t===K&&n.type!==G.Number&&n.type!==G.CloseGroupDelimiter||a()}else if(t===F){a();const[t,n]=V(e.slice(c+1));o=`${F}${t}${P}`,a(),c+=n}else U(t)&&""!==o?a():U(t)||(o+=t)}return a(),r}var H={lexSource:function(t){const n=t.split(/\r?\n/),e=[];for(let r=0;r<n.length;r++){const t=z(n[r],r+1);t.length>0&&e.push(t)}return e}};function J(t){return"object"==typeof t&&"function"==typeof t.then?t:Promise.resolve(t)}var Q={promisifyExec:function(t,n){return J(t.execute(n))},promisifyResult:J},W={};const{promisifyExec:X}=Q;function Y(t){this.type="BinaryExpression",this.operator=t}const Z={"+":(t,n)=>t+n,"-":(t,n)=>t-n,"*":(t,n)=>t*n,"/":(t,n)=>t/n},_={and:(t,n)=>t&&n,or:(t,n)=>t||n};function tt(t,n){return function(e,r){if("number"!=typeof e||"number"!=typeof r)throw new Error(`Cannot compare non-number values with ${t} operator.`);return n(e,r)}}const nt={isgreaterthan:tt("isGreaterThan",(t,n)=>t>n),islessthan:tt("isLessThan",(t,n)=>t<n),isgreaterorequalto:tt("isGreaterOrEqualTo",(t,n)=>!(t<n)),islessorequalto:tt("isLessOrEqualTo",(t,n)=>!(t>n)),isequalto:(t,n)=>t===n};Y.prototype={setLeft:function(t){this.left=t},setRight:function(t){this.right=t},toString:function(){return`${this.left.toString()} ${this.operator} ${this.right.toString()}`},performOperation:function(t,n){return Object.keys(Z).includes(this.operator)?function(t,n,e){if("number"!=typeof n||"number"!=typeof e)throw new Error(`Arithmetic operations can only be run on numbers. Received ${n} of type ${typeof n} && ${e} of type ${typeof e}.`);return Z[t](n,e)}(this.operator,t,n):Object.keys(nt).includes(this.operator)?(e=this.operator,r=t,o=n,nt[e](r,o)):function(t,n,e){return _[t](n,e)}(this.operator,t,n);var e,r,o},execute:async function(t){let n=await X(this.left,t),e=await X(this.right,t);return await Promise.resolve(this.performOperation(n,e))}},Y.new=function(t){return new Y(t)},W=Y;var et=function(t,n){return n.split("\n").map(n=>t+n).join("\n")},rt={};const{promisifyExec:ot}=Q,{getNil:it}=t;function st(t,n){this.type="Conditional",this.blockType=t,this.condition=n,this.success=[],this.fail=null}st.prototype={setSuccess:function(t){this.success=Array.isArray(t)?t:[]},setFail:function(t){null===this.fail?this.fail=t:this.fail.setFail(t)},toString:function(){const t=`${blockType} ${"else"!==blockType?this.condition.toString():""}`,n=this.success.map(t=>et("    ",t.toString()));let e=[t].concat(n);return null!==this.fail&&e.concat(this.fail.toString()),"if"===this.blockType&&e.concat("end"),e.join("\n")},execute:async function(t){const n=t.new();let e=await ot(this.condition,n),r=it();if(e){const t=this.success;for(let e=0;e<t.length;e++)r=await ot(t[e],n);return r}return null!==this.fail?ot(this.fail,t):r}},st.new=function(t,n){return new st(t,n)},rt=st;var at={};const{promisifyExec:ct,promisifyResult:ut}=Q;function ft(t){this.type="FunctionCall",this.name=t,this.arguments=[]}ft.prototype={addArguments:function(t){this.arguments=t},toString:function(){const t=this.arguments.map(t=>t.toString());return[this.name+":"].concat(t).join(" ")},execute:async function(t){const n=t.read(this.name);if("function"!=typeof n)throw new Error(`Cannot call ${this.name}, it is not a function.`);{let e=[];for(let n=0;n<this.arguments.length;n++){const r=await ct(this.arguments[n],t);e.push(r)}return await ut(n.apply(null,e))}}},ft.new=function(t){return new ft(t)},at=ft;var lt={};const{promisifyExec:pt}=Q;function ht(t,n,e){this.type="FunctionDeclaration",this.name=t,this.line=e,this.parameters=n,this.body=[]}ht.prototype={setBody:function(t){this.body=t},toString:function(){let t="declare function "+this.name;this.parameters.length>0&&(t+=" withparameters "+this.parameters.map(t=>t.toString()).join(" "));const n=this.body.map(t=>et("    ",t.toString()));return[t].concat(n).concat(["end"]).join("\n")},execute:async function(t){const n=async(...n)=>{if(n.length!==this.parameters.length)throw new Error(`Function '${this.name}' takes ${this.parameters.length} arguments, but received ${n.length}.`);const e=t.new();for(let t=0;t<this.parameters.length;t++){const r=this.parameters[t].toString();e.initialize(r,n[t])}let r;for(let t=0;t<this.body.length;t++){const n=this.body[t];r=await pt(n,e)}return r};return t.define(this.name.name.toLowerCase(),n),n}},ht.new=function(t,n,e){return new ht(t,n,e)},lt=ht;var yt={};const{promisifyExec:dt}=Q;function wt(){this.type="Group",this.body}wt.prototype={setBody:function(t){this.body=t},toString:function(){return`(${this.body.toString()})`},execute:async function(t){return await dt(this.body,t)}},wt.new=function(){return new wt},yt=wt;var mt={};function gt(t,n){this.type="Identifier",this.name=t,this.originalName=n}gt.prototype={toString:function(){return this.name},execute:async function(t){return await Promise.resolve(t.read(this.name))}},gt.new=function(t,n){return new gt(t,n)},mt=gt;var bt={};const{promisifyExec:vt}=Q;function kt(t,n,e,r){this.type="InitializationExpression",this.line=r,this.variableType=t,this.identifier=n,this.value=e}kt.prototype={toString:function(){return"let"===this.variableType?`let ${this.identifier.toString()} be ${this.value.toString()}`:`define ${this.identifier.toString()} as ${this.value.toString()}`},execute:async function(t){const n=await vt(this.value,t);return"let"===this.variableType?t.initialize(this.identifier.name,n):t.define(this.identifier.name,n),n}},kt.new=function(t,n,e,r){return new kt(t,n,e,r)},bt=kt;var Et={};const{promisifyResult:St}=Q;function Tt(t){this.type="Literal",this.value=function(t){switch(t.type){case"String":return t.token.replace(/^\"(.*)\"$/,"$1");case"Number":return Number(t.token);case"Boolean":return"true"===t.token;default:return null}}(t)}Tt.prototype={toString:function(){return"string"==typeof this.value?`"${this.value}"`:this.value.toString()},execute:async function(){return await St(this.value)}},Tt.new=function(t){return new Tt(t)},Et=Tt;var $t={};const{promisifyExec:xt}=Q;function Ct(t){this.type="Loop",this.condition=t,this.body=[]}Ct.prototype={setBody:function(t){this.body=t},toString:function(){const t="loop while "+this.condition.toString(),n=this.body.map(t=>et("    ",t.toString()));return[t].concat(n).concat(["end"]).join("\n")},execute:async function(t){const n=t.new();let e,r=await xt(this.condition,n);for(;r;){const t=n.new();for(let n=0;n<this.body.length;n++)e=await xt(this.body[n],t);r=await xt(this.condition,n)}return e}},Ct.new=function(t){return new Ct(t)},$t=Ct;var Ot={};const{promisifyExec:Lt}=Q;function At(t){this.type="Program",this.body=t}At.prototype={addBodyNode:function(t){this.body.push(t)},toString:function(){const t=this.body.map(t=>et("    ",t.toString()));return["begin"].concat(t).concat("end").join("\n")},execute:async function(t){try{for(let n=0;n<this.body.length;n++)await Lt(this.body[n],t)}catch(n){if(n.message.includes("'length'"))throw n;t.read("print")(n.message)}}},At.new=function(t){return new At(t)},Ot=At;var jt={};const{promisifyExec:It}=Q;function Bt(t,n){this.type="UpdateExpression",this.identifier=t,this.value=n}function Dt(t,n){return t.splice(0,n),t}function Nt(t){return t.map(t=>Array.isArray(t)?t[0].token.toString():t.token.toString()).join(" ")}function Gt(t){return t.splice(0,1)[0]}function Ft(t,n){const e=t[0].line,r=Dt(t,2),o=Yt(t),i=[];r.length>2&&"withparameters"===r[1].token&&Dt(r,2).forEach((function(t){i.push(Yt([t]))}));const s=lt.new(o,i,e),a=Kt(n);return s.setBody(a),s}function Pt(t,n){const e=Vt(Dt(t,2).slice(0)),r=$t.new(e),o=Kt(n);return r.setBody(o),r}function Rt(t){return"else"===t[0].token}function Mt(t,n){const e=Vt(Dt(t,1).slice(0)),r=rt.new("if",e),o=Kt(n);let i,s;r.setSuccess(o);do{if(s=(i="else"===n[0][0].token)&&1===n[0].length,i){const t=s?"else":"else if";let e;s?e=Et.new({type:"Boolean",token:"true"}):(Dt(n[0],2),e=Vt(n[0]));const o=rt.new(t,e),i=Kt(Dt(n,1));o.setSuccess(i),r.setFail(o)}if(s)break}while(i);return r}function qt(t){return t[t.length-1]}function Kt(t){const n=[];for(;t.length>0&&"end"!==t[0][0].token;){let o,i=Gt(t);for(;"LineContinuationOperator"===qt(i).type;)i.pop(),i=i.concat(Gt(t));if("LineContinuationOperator"===qt(i).type&&(i.pop(),currentToken),"if"===i[0].token)o=Mt(i,t);else{if(Rt(i))return t.unshift(i),n;o=(e=i).length>2&&"declare"===e[0].token&&"function"===e[1].token&&"Identifier"===e[2].type?Ft(i,t):"loop"!==(r=i)[0].token&&"repeat"!==r[0].token||"while"!==r[1].token?Vt(i.slice(0)):Pt(i,t)}n.push(o)}var e,r;if(0===t.length)throw new Error('Incomplete program: an "end" declaration is missing.');return Dt(t,1),n}Bt.prototype={toString:function(){return`update ${this.identifier.toString()} to ${this.value.toString()}`},execute:async function(t){const n=await It(this.value,t);return t.update(this.identifier.name,n),n}},Bt.new=function(t,n){return new Bt(t,n)},jt=Bt;const Ut=[[function(t){return t.length>2&&(Jt([t[0]])||Qt([t[0]]))&&function(t){return"Operator"===t[0].type}([t[1]])},function(t){const n=W.new(t[1].token);if(n.setLeft(Vt([t[0]])),["and","*","/"].includes(t[1].token)){let e;if(Jt([t[2]])||Qt([t[2]]))e=t[2],Dt(t,3);else{if(!Wt([t[2]]))throw new Error("Arithmetic expression contains an error: ",Nt(t));Xt(Dt(t,2)),e=t[0],Dt(t,1)}n.setRight(Vt([e]));const r=function(t){return{type:"ParsedBinaryExpression",token:t}}(n);return t.unshift(r),Vt(t)}return n.setRight(Vt(Dt(t,2))),n}],[Jt,function(t){return Ht.includes(t[0].type)?t[0].token:Et.new(t[0])}],[Wt,Xt],[Qt,Yt],[function(t){return t.length>3&&("let"===t[0].token&&"be"===t[2].token||"define"===t[0].token&&"as"===t[2].token)},function(t){const n=t[0].line,e=t[0].token,r=Yt([t[1]]),o=Vt(Dt(t,3));return bt.new(e,r,o,n)}],[function(t){return t.length>3&&"update"===t[0].token&&"to"===t[2].token},function(t){const n=mt.new(t[1].token),e=Vt(Dt(t,3));return jt.new(n,e)}],[function(t){return t.length>2&&"Identifier"===t[0].type&&"FunctionExecutionIndicator"===t[1].type||"CallOperator"===t[0].type||"InfixOperator"===t[0].type},function(t){if("CallOperator"===t[0].type)Dt(t,1);else if("InfixOperator"===t[0].type){const n=t[0],e=t[2],r=t[1];t[0]=e,t[1]=n,t[2]=r}const n=at.new(t[0].token),e=Vt(Dt(t,2)),r=Array.isArray(e)?e:[e].filter(t=>Boolean(t));return n.addArguments(r),n}]];function Vt(t){if(0===t.length)return;const n=Ut.find(n=>n[0](t));if(function(t){return"CloseGroupDelimiter"===t[0].type}(t))Dt(t,1);else{if(Boolean(n))return n[1](t);if(t.length>1&&"operator"!==t[0].type){const n=Vt([t[0]]);if(Dt(t,1),"operator"===t[0].type)return n;{const e=Vt(t);return Boolean(e)?[n].concat(e):n}}!function(t){const n=Boolean(t[0].line)?t[0].line:"unknown line";throw new Error(`Unable to interpret this program, an error exists at line ${n} near "${Nt(t)}"`)}(t)}}const zt=["Number","Boolean","String"],Ht=["ParsedTokenSet","ParsedBinaryExpression"];function Jt(t){return 1===t.length&&(zt.includes(t[0].type)||Ht.includes(t[0].type))}function Qt(t){return 1===t.length&&"Identifier"===t[0].type}function Wt(t){return"OpenGroupDelimiter"===t[0].type}function Xt(t){const n=yt.new(),e=Vt(Dt(t,1));if(!Boolean(e)||Array.isArray(e))throw new Error(`Unparseable group in source: "${Nt(t)}"`);n.setBody(e);const r={type:"ParsedTokenSet",token:n};return t.unshift(r),Vt(t)}function Yt(t){return mt.new(t[0].token,t[0].originalToken)}var Zt=function(t){const n=Kt(t.slice(1));return Ot.new(n)};function _t(t){const n=H.lexSource(t);return Zt(n)}var tn={lexSource:H.lexSource,parseSource:_t,loadAndRun:function(t,n){const e=function(t){const n=s.new(),e=$(t);return Object.keys(e).forEach((function(t){n.define(t.toLowerCase(),e[t])})),n}(n);return _t(t).execute(e)}};"object"==typeof window&&(window.loadAndRunProgram=tn.loadAndRun,window.lexSource=tn.lexSource,window.parseSource=tn.parseSource)}();